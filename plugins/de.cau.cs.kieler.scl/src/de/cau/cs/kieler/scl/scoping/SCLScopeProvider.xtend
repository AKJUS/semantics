/*
 * generated by Xtext
 */
package de.cau.cs.kieler.scl.scoping

import de.cau.cs.kieler.kexpressions.kext.scoping.KExtScopeProvider
import de.cau.cs.kieler.scl.Label
import de.cau.cs.kieler.scl.SCLProgram
import java.util.Collections
import org.eclipse.emf.ecore.EObject
import org.eclipse.xtext.naming.QualifiedName
import org.eclipse.xtext.resource.EObjectDescription
import org.eclipse.xtext.resource.IEObjectDescription

/**
 * This class contains custom scoping description.
 * 
 * See https://www.eclipse.org/Xtext/documentation/303_runtime_concepts.html#scoping
 * on how and when to use it.
 *
 */
class SCLScopeProvider extends KExtScopeProvider {

    def labelScope(EObject context) {
        var program = context
        while (program != null) {
            if (program instanceof SCLProgram) {
                return (program as SCLProgram).eAllContents.filter(Label).map [
                    new EObjectDescription(QualifiedName.create(it.name), it, Collections.<String, String>emptyMap()) as IEObjectDescription
                ].toList
            }
            program = program.eContainer
        }
    }

}
