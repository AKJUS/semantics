<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
       "http://www.w3.org/TR/html4/loose.dtd"><head>
<title>KIELER SCCharts Compiler - Sequentially Constructive Charts - KIELER Compiler - KiCo </title>
<meta http-equiv="expires" content="0">
<style type="text/css">
<!--
.Stil8 {
	font-family: Verdana, Arial, Helvetica, sans-serif;
	font-size: small;
}
-->
</style>
</head>

	   <style type="text/css">
<!--
.Stil1 {
	font-size: xx-large;
	font-weight: bold;
	font-family: Verdana, Arial, Helvetica, sans-serif;
}
.Stil3 {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: xx-large;}
.Stil4 {color: #0000FF}
.Stil10 {font-size: small}
.Stil12 {font-size: x-small}
.Stil13 {font-size: xx-small}
.Stil15 {font-family: Verdana, Arial, Helvetica, sans-serif; font-size: x-small; }
.Stil18 {font-size: xx-small; font-weight: bold; }
.Stil20 {color: #999999}
-->
       </style>

<script>

if (top.location.href != "http://rtsys.informatik.uni-kiel.de/confluence/display/KIELER/Online+Compiler") {
	top.location.href="http://rtsys.informatik.uni-kiel.de/confluence/display/KIELER/Online+Compiler"
}


//function processEvent(e) {
//  alert('Parent got (from ' + e.origin + '): ' + e.data);
//  var textEdit = document.getElementById("transformations");
//  var textValue = textEdit.value;
//  if (textValue != "") {
//  	textValue += ", ";
//  }
//  textValue += e.data;
//  textEdit.value = textValue;
//}
// Receiver transformation selections
//window.addEventListener('message', processEvent, false);


var windowContent = "<img src='http://www.sccharts.com/transformations.jpg' alt='s' border='0' usemap='#Map' />\
<map name='Map' id='Map'>\
  <area shape='rect' coords='4,3,837,19' href='javascript:void(0)' onClick='document.getElementById(\"transformations\").value=\"EXTENDED\"'/><area shape='rect' coords='410,51,830,68' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"STATECHARTS\"'/><area shape='rect' coords='211,103,349,118' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SCADEQUARTZESTEREL\"'/><area shape='rect' coords='18,67,68,85' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"REFERENCE\"'/>\
  <area shape='rect' coords='80,68,103,84' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"MAP\"'/>\
  <area shape='rect' coords='114,65,137,85' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"FOR\"' />\
  <area shape='rect' coords='176,66,200,84' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"PRE\"' /><area shape='rect' coords='217,66,251,85' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SIGNAL\"' /><area shape='rect' coords='268,65,308,84' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SUSPEND\"'/><area shape='rect' coords='324,67,383,83' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"COUNTDELAY\"'/><area shape='rect' coords='218,131,282,148' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"WEAKSUSPEND\"'/><area shape='rect' coords='299,130,338,146' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"DEFERRED\"'/><area shape='rect' coords='252,162,282,176' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"HISTORY\"'/><area shape='rect' coords='297,158,328,173' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"STATIC\"'/><area shape='rect' coords='419,109,500,125' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"COMPLEXFINALSTATES\"' /><area shape='rect' coords='513,77,598,94' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"ABORT\"'/><area shape='rect' coords='528,103,584,120' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"ABORTDEFAULT\"'/><area shape='rect' coords='521,129,589,149' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"ABORTALTERNATIVE\"'/><area shape='rect' coords='609,121,647,139' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"DURING\"'/><area shape='rect' coords='614,149,645,170' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"CONST\"'/><area shape='rect' coords='675,103,699,120' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"EXIT\"'/><area shape='rect' coords='660,147,714,163' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"INITIALIZATION\"'/><area shape='rect' coords='727,146,755,163' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"ENTRY\"'/><area shape='rect' coords='772,144,825,162' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"CONNECTOR\"'/><area shape='rect' coords='851,73,1015,89' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"CORE\"'/><area shape='rect' coords='859,98,933,117' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"TRIGGEREFFECT\"'/><area shape='rect' coords='943,99,1006,116' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SURFACEDEPTH\"'/><area shape='rect' coords='1026,59,1396,75' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SCGRAPH\"'/><area shape='rect' coords='1036,99,1062,115' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SCG\"'/><area shape='rect' coords='1072,98,1133,117' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SCGDEP\"'/><area shape='rect' coords='1141,84,1216,100' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SCGBBGROUP\"'/><area shape='rect' coords='1155,106,1207,121' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SCGBB\"' /><area shape='rect' coords='1225,85,1314,100' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SCGSCHEDGROUP\"'/><area shape='rect' coords='1233,104,1307,121' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SCGSCHEDSIMPLE\"'/><area shape='rect' coords='1325,100,1388,115' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SCGSEQ\"'/><area shape='rect' coords='1406,77,1486,91' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"CODEGENERATION\"' /><area shape='rect' coords='1412,98,1454,114' href='javascript:void(0)'  onClick='document.getElementById(\"transformations\").value=\"SCG2C\"' />\
  <area shape='rect' coords='10,39,142,53' href='javascript:void(0)' onClick='document.getElementById(\"transformations\").value=\"EXPANSIONS\"'/>\
  <area shape='rect' coords='170,41,387,55' href='javascript:void(0)' onClick='document.getElementById(\"transformations\").value=\"SYNCCHARTS\"'/>\
</map>\
<input name='transformations' type='hidden' id='transformations' size='94' value='' style='width: 100%' />\
<br />\
    <span style='font-family: Verdana, Arial, Helvetica, sans-serif;\
	font-size: x-small'>Click on the transformation that you like to add to the list of applied compilation transformations.</span> </div>";

var mywindow;
function openSelectWindow() {
  try {
		if (!mywindow.closed) {
			 mywindow.focus();
			return;
		}
	}catch(e) {
  }
  transformationsTimer=setInterval(function(){updateTransformations()},500);
  mywindow = window.open("", "selectWindow", "width=950,height=270, resizable=yes, toolbar=no, scrollbars=yes, menubar=no, status=no, directories=no");
  mywindow.document.write(windowContent);
  
  mywindow.focus();
}


function updateTransformations() {
	window.clearInterval(transformationsTimer);
	var newValue = "-1";
	try {
		if (mywindow.closed) {
			return;
		}
		newValue = mywindow.document.getElementById("transformations").value;
	}catch(e) {
   	}
	//alert(newValue);
	if (newValue == "") {
		//nothing selected
		transformationsTimer=setInterval(function(){updateTransformations()},500);
	}
	else if (newValue != "-1") {
	  var textEdit = document.getElementById('transformations');
	  var textValue = textEdit.value;
	  if (textValue != '') {
	  	textValue += ', ';
	  }
	  textValue += newValue;
	  textEdit.value = textValue;
	  mywindow.document.getElementById("transformations").value = "";
   	  transformationsTimer=setInterval(function(){updateTransformations()},500);
	  compile();
	}
}
var transformationsTimer;


function setResultText() {
    var scale = document.getElementById("scale");
	scale.disabled = true;
    var size = document.getElementById("size");
	size.disabled = true;
    var image = document.getElementById("resultImageDiv");
    var text = document.getElementById("resultTextDiv");
	text.style.display="block";
	image.style.display="none";
	compile();
//	alert("setResultText" + image + text);
}

function setResultImage() {
    var scale = document.getElementById("scale");
	scale.disabled = false;
    var size = document.getElementById("size");
	size.disabled = false;
//	alert("setResultImage");
    var image = document.getElementById("resultImageDiv");
    var text = document.getElementById("resultTextDiv");
	image.style.display="block";
	text.style.display="none";
	compile();
}

var doUpdateImage = false;

function compile() {
	window.clearInterval(compileTimer);
	resultText.value = "Compiling, please wait...";
	clearErrors();
    var outputText = document.getElementById("outputText");
    if(outputText.checked) {
		doUpdateImage = false;
		compileText();
	}
	else {
		doUpdateImage = true;
		compileText();
	}
}

function replaceAll(inputStr, findStr, replaceStr) {
  return inputStr.split(findStr).join(replaceStr);
}

function compileText() {
    var strict = document.getElementById("strict").checked;
    var verbose = 0;//document.getElementById("verbose").checked;

	var resultUrl =  document.getElementById("KiCoURL").value + "/?model="+encodeURIComponent(model.value) + "&transformations=" + encodeURIComponent(transformations.value) + "&verbose="+verbose+"&strict=" + strict; // + "#" + new Date().getTime();

	var xmlhttp = new XMLHttpRequest();
	xmlhttp.onreadystatechange=function() {
  		if (xmlhttp.readyState==4 && xmlhttp.status==200) {
	      var resultText = document.getElementById("resultText");
   		  resultText.value = xmlhttp.responseText;

		  var errorMsg = xmlhttp.getResponseHeader("compile-error");
		  if (errorMsg != null) {
			  var resultError = document.getElementById("resultError");
			  var resultErrorDiv = document.getElementById("resultErrorDiv");
	  	  	  resultErrorDiv.style.display="block";
			  resultError.value = replaceAll(decodeURIComponent(errorMsg), "+", " ");
		  } else {
		  	  clearErrors();
		  }

		  if (doUpdateImage) {
		  		updateImage();
	      }
		}
	}
	xmlhttp.open('GET', resultUrl, true);
	xmlhttp.send();
}

function clearErrors() {
			  var resultError = document.getElementById("resultError");
			  var resultErrorDiv = document.getElementById("resultErrorDiv");
	  	  	  resultErrorDiv.style.display="none";
			  resultError.value = "";
}





function testOnlineStatus(redAndGreenImageId, serverURL) {
	   var testImage = new Image();
	   testImage.src = serverURL + "/?online=1#" + new Date().getTime();
	   
  	   testImage.onload = function() {
			if (testImage.height > 0) {
			    var redAndGreenImage = document.getElementById(redAndGreenImageId);
				redAndGreenImage.src = "http://www.sccharts.com/green.png";
			}
	    }
}

function testAllOnlineStatus() {
	testOnlineStatus("onlineserver1", "http://www.sccharts.com:5556");
	testOnlineStatus("onlineserver2", "http://www.sccharts.com:5555");
	testOnlineStatus("onlinelocalhost", "http://localhost:5555");
}

testAllOnlineStatus();


function updateImage() {
    var image = document.getElementById("resultImage");
    if(image.complete) {
	    var model = document.getElementById("model")
	    var transformations = document.getElementById("transformations")
	    var scale = document.getElementById("scale")
        var new_image = new Image();
        //set up the new image
        new_image.id = "resultImage";
		var imageUrl = document.getElementById("KLighDURL").value + "/?model="+encodeURIComponent(resultText.value) + "&transformations=" + encodeURIComponent(transformations.value) + "&scale=" + encodeURIComponent(scale.value) + "#" + new Date().getTime();
        new_image.src = imageUrl;
        // insert new image and remove old
        image.parentNode.insertBefore(new_image, image);
        image.parentNode.removeChild(image);

		new_image.onload = function() {
			var size = document.getElementById("size");
			var width = new_image.naturalWidth;
			var height = new_image.naturalHeight;
			new_image.width = width/size.value;
			new_image.height = height/size.value;
	    }
		//var width = new_image.naturalWidth;
		//var height = new_image.naturalHeight;
		//alert(width + "," + height);
		//new_image.width = "50%";
		//new_image.height = "50%";

    }
}

</script>

<div align="center">
  <p><img src="http://www.sccharts.com/sccharts.png" width="512" height="150" /></p>
  <p><span class="Stil3">Sequentially Constructive Charts &mdash; SCCharts</span><span class="Stil1"><br />
      <span class="Stil4">ONLINE COMPILER</span></span><br>
      <span class="Stil15">If after a while there is still no compilation result, please select another server or local host <a href="#server">below</a>.</span> </p>
    <table width="300" border="0" cellspacing="0">
      <tr>
        <td colspan="2" valign="top" scope="row"><label></label>
          <table width="300" border="0" cellspacing="10">
            <tr>
              <th valign="top" scope="row"><div align="right" class="Stil8">
                <p>1. Textual SCChart (SCT)<br>
                <span class="Stil12">                (see <a href="http://rtsys.informatik.uni-kiel.de/confluence/display/KIELER/SCT+-+Textual+Description+Language+for+SCCharts" target="_blank">here</a>) </span></p>
                </div></th>
              <td valign="top"><label>
                <textarea name="model" cols="70" rows="25" id="model" onchange="compile();">
@HVLayout
scchart ABRO {
  input bool A;
  input bool B;
  input bool R;
  output bool O = false;

  region Main:

  initial state ABO {

    initial state WaitAB {

      region HandleA:

      initial state WA
      --> DA with A;

      final state DA;

      region HandleB:

      initial state WB
      --> DB with B;

      final state DB;
    }
    >-> Done with / O = true;

    state Done;
  }
  o-> ABO with R;
}
            </textarea>
              </label></td>
            </tr>
            <tr>
              <th valign="top" scope="row"><div align="right" class="Stil8">2. Compile Transformations<br />
                <span class="Stil15 Stil13 Stil13">(comma separated)</span></div></th>
              <td><label>
			  <div class="input-w"  style="width: auto">
                <p>
                  <input name="transformations" type="text" id="transformations" size="94" value="ABORT" style="width: 100%"/>
                  <span class="Stil15">Examples: ABORT, INITIALIZATION, ENTRY, SCG, SCGRAPH, CODEGENERATION</span><input type="submit" name="selectTransformations" value="Select Transformations ..." onClick="openSelectWindow()" />
                </p>
                </div>
              </label></td>
            </tr>
            <tr>
              <th valign="top" scope="row"><p align="right" class="Stil8">3. Other Options </p></th>
              <td align="left"><p>
                <label>
                <span class="Stil8">
                <input name="strict" type="checkbox" id="strict" value="true" onclick="compile();">
                Strict</span></label>
                <span class="Stil8 Stil10">(only apply the listed transformations)
                <label></label>
                </span></p>
                <p>
                  <span class="Stil8 Stil10">
                  <label>
                  <input name="output" type="radio" id="outputText" onclick="setResultText();" value="text" checked />
                  <img src="http://www.sccharts.com/text.png" alt=" " width="11" height="14" />                  Textual output </label>
                  <label> <br>
                  <input type="radio" name="output" value="graph" id="outputImage" onclick="setResultImage();" />
                  <img src="http://www.sccharts.com/model.png" alt=" " width="11" height="14" />                Graphical output <BR>
                <BR>
&nbsp; 	&nbsp; 	 	&nbsp; Image Quality: </label>

                  <label></label>
                  <label></label>
                  </span>
                  <span class="Stil8 Stil10">
                  <label> </label>
                  <select name="scale" id="scale" onchange="compile();">
                    <option>1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                  </select>
                  , Size:
                  <select name="size" id="size" onchange="compile();">
                    <option value="1">100%</option>
                    <option value="1.5">75%</option>
                    <option value="2">50%</option>
                    <option value="4">25%</option>
                    <option value="10">10%</option>
                  </select>
                  </span><br>
                  <br>
                <span class="Stil8 Stil12"><a href="#" onclick="toggleAdvanced();">Advanced Options</a></span></p>
<table width="327" border="0" cellspacing="5">
                      <tr>
                        <td width="315" valign="top" scope="row"><span class="Stil8">
                        <label>
                          <input type="radio" name="config" value="server0" id="radio0" disabled="disabled" />
                        <img src="http://www.sccharts.com/red.png" alt="Red means this server is down, green means this server is up and can be used." width="11" height="11" id="onlineserver3"> <span class="Stil20">Main Server (available shortly)</span></label>
                          <br>
                          <label>
                        <a name="server"></a>
                        <input type="radio" name="config" value="server1" id="radio" checked="true" onclick="setConfig(1);" />
                        <img src="http://www.sccharts.com/red.png" alt="Red means this server is down, green means this server is up and can be used." width="11" height="11" id="onlineserver1">                        Backup Server 1</label>
                          <br>
                          <label>
                          <input type="radio" name="config" value="server2" id="radio2" onclick="setConfig(2);" />
                        <img src="http://www.sccharts.com/red.png" alt="Red means this server is down, green means this server is up and can be used." width="11" height="11" id="onlineserver2"> Backup Server 2</label>
                          <br>
                          <label>
                          <input type="radio" name="config" value="localhost" id="radio4" onclick="setConfig(3);" />
                          <img src="http://www.sccharts.com/red.png" alt="Red means this server is down, green means this server is up and can be used." width="11" height="11" id="onlinelocalhost"> Local Host <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Stil18">(KIELER HTTP Servers must run&nbsp;locally, see <a href="http://rtsys.informatik.uni-kiel.de/confluence/display/KIELER/KIELER+Compiler+Console" target="_blank">here</a> and <a href="http://rtsys.informatik.uni-kiel.de/confluence/display/KIELER/KIELER+KLighD+Console+Diagram+Rendering" target="_blank">here</a>)</span></label>
</span><span class="Stil8">
                      <label></label>
                        </span><span class="Stil8">
                          <label></label>
                        </span></td>
                      </tr>
                </table>
					
		<div id="advancedOptions" style="font:24px bold; display: none">
		<span class="Stil8 Stil10">
                <table width="370" border="0" cellspacing="5">
                  <tr>
                    <th width="200" scope="row"><div align="right">KielerCompiler URL: </div></th>
                    <td width="200"><label>
                      <input name="KiCoURL" type="text" id="KiCoURL" size="30" value="http://www.sccharts.com:5556">
                    </label></td>
                  </tr>
                  <tr>
                    <th scope="row"><div align="right">KLighD URL: </div></th>
                    <td><input name="KLighDURL" type="text" id="KLighDURL" size="30" value="http://www.sccharts.com:4445"></td>
                  </tr>
                  <tr>
                    <th scope="row"><div align="right">Refresh-Time:</div></th>
                    <td><input name="refreshTime" type="text" id="refreshTime" size="30" value="2000"></td>
                  </tr>
                </table>  
		</span></div></td>
            </tr>
            <tr>
              <th scope="row"><label></label></th>
              <th scope="row"><div align="left">
                  <input type="submit" name="Submit" value=" Compile / Update " onclick="compile();" />
              </div></th>
            </tr>
          </table>
          <p><br />
          </p></td>
        <td  valign="top">

          <table width="300" border="0" cellspacing="10">
            <tr><td>

		<div id="resultErrorDiv" style="font:24px bold; display: none">
          <textarea name="resultError" cols="70" rows="4" id="resultError" readonly=true style="background-color: #FF0000"></textarea>
		  <br>
		 </div>
		<div id="resultImageDiv" style="font:24px bold; display: none">
        <img src="xxx" name="resultImage" id="resultImage"/></div>
		<div id="resultTextDiv" style="font:24px bold; display: block">
          <textarea name="resultText" cols="70" rows="25" id="resultText" readonly=true style="background-color: #CCCCCC"></textarea>
		  </div>
		  </td>
      </tr>
    </table>


	    </td>
      </tr>
    </table>
  <p><span class="Stil15">copyright (c) 2014 Reinhard von Hanxleden, Christian Motika, Steven Smyth, see: </span> <a href="http://rtsys.informatik.uni-kiel.de/confluence/display/KIELER/SCCharts" class="Stil15">http://rtsys.informatik.uni-kiel.de/confluence/display/KIELER/SCCharts</a><br />
  </p>
</div>

<script>

var advancedShown = false;
function toggleAdvanced() {
  advancedShown = !advancedShown;
  if (advancedShown) {
	document.getElementById('advancedOptions').style.display='block';
  }
  else {
	document.getElementById('advancedOptions').style.display='none';
  }
}


function setConfig(i) {
	if (i == 1) {
		document.getElementById("KiCoURL").value = "http://www.sccharts.com:5556";
		document.getElementById("KLighDURL").value = "http://www.sccharts.com:4445";
	}
	else if (i == 2) {
		document.getElementById("KiCoURL").value = "http://www.sccharts.com:5555";
		document.getElementById("KLighDURL").value = "http://www.sccharts.com:4444";
	}
	else {
		document.getElementById("KiCoURL").value = "http://localhost:5555";
		document.getElementById("KLighDURL").value = "http://localhost:4444";
	}
	compile();
}




var compileTimer=setInterval(function(){compile()},document.getElementById("refreshTime").value);

var area = document.getElementById("model");
if (area.addEventListener) {
  area.addEventListener('input', function() {
    // event handling code for sane browsers
	window.clearInterval(compileTimer);
	compileTimer=setInterval(function(){compile()},document.getElementById("refreshTime").value);
  }, false);
} else if (area.attachEvent) {
  area.attachEvent('onpropertychange', function() {
    // IE-specific event handling code
	window.clearInterval(compileTimer);
	compileTimer=setInterval(function(){compile()},document.getElementById("refreshTime").value);
  });
}


var area = document.getElementById("transformations");
if (area.addEventListener) {
  area.addEventListener('input', function() {
    // event handling code for sane browsers
	window.clearInterval(compileTimer);
	compileTimer=setInterval(function(){compile()},document.getElementById("refreshTime").value);
  }, false);
} else if (area.attachEvent) {
  area.attachEvent('onpropertychange', function() {
    // IE-specific event handling code
	window.clearInterval(compileTimer);
	compileTimer=setInterval(function(){compile()},document.getElementById("refreshTime").value);
  });
}

</script>
